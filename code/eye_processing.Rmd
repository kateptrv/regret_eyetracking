---
title: "eye_processing"
author: "Kate Petrova"
date: "2025-08-05"
output: html_document
---

# Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(include = TRUE)

if(!suppressWarnings(require(pacman))){install.packages("pacman");library("pacman")}
p_load(tidyverse, tidyr, dplyr, ggplot2, stats, sjPlot, readr, ggpubr, patchwork, lubridate, ggthemr, ggdist, showtext, eyelinkReader, usethis)
```

```{r}
ggthemr("fresh")
```

```{r}
usethis::edit_r_environ()
```

```{r}
getwd()
```

# Test

```{r}
test <- read_edf('../data/456545_regret_experiment_2025-07-29_14h33.31.756.EDF')
```

```{r}
#View(test$saccades)
plot(test, trial = NULL, show_fixations = TRUE, show_saccades = FALSE) +
    coord_cartesian(xlim = c(0, 1920), ylim = c(0, 1080)) +
  scale_y_reverse()
```

# Data upload

```{r}
edf_files <- list.files("../data", pattern = "\\.EDF$", full.names = TRUE)

# extract participant IDs
get_pid <- function(path) {
  stringr::str_extract(basename(path), "^\\d{6}")
}

edf_data_list <- edf_files |>
  set_names(get_pid) |>
  map(~ read_edf(.x))

```

# Analyses

```{r}
# Plot fixations (or saccades) separately for each participant
walk2(
  edf_data_list,
  names(edf_data_list),
  ~ {
    print(paste("Plotting participant", .y))
    print(plot(.x, trial = NULL, show_fixations = TRUE, show_saccades = FALSE))
  }
)
```
